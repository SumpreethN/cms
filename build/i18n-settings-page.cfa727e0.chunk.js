"use strict";(self.webpackChunkcmssample=self.webpackChunkcmssample||[]).push([[3552],{31701:(Ue,b,t)=>{t.r(b),t.d(b,{default:()=>Ge});var e=t(27279),u=t(57537),le=t(39510),ne=t(70627),c=t.n(ne),se=t(9941),oe=t(27875),L=t(48102),ie=t(74758),ce=t(6191),I=t(36938),de=t(52448),v=t(61020),z=t(47235),s=t(3804),V=t(5938),G=t(6918),E=t(21395),H=t(15244),U=t(69878),T=t(10701),C=t(94098),W=t(84366),j=t(93415),S=t(61908),Q=t(35250),X=t(59082),M=t(71563),re=t(98934),me=t.n(re),F=t(49402),N=t(70437);const ue=()=>{const[l,n]=(0,e.useState)(!1),o=(0,F.I0)(),a=(0,u.useNotification)(),{post:i}=(0,u.useFetchClient)();return{isAdding:l,addLocale:async r=>{n(!0);try{const{data:m}=await i("/i18n/locales",r);a({type:"success",message:{id:(0,s.O)("Settings.locales.modal.create.success")}}),o({type:N.xz,newLocale:m})}catch(m){const g=me()(m,"response.payload.message",null);throw g&&g.includes("already exists")?a({type:"warning",message:{id:(0,s.O)("Settings.locales.modal.create.alreadyExist")}}):a({type:"warning",message:{id:"notification.error"}}),m}finally{n(!1)}}}};var x=t(47853);const $=(0,x.Ry)().shape({code:(0,x.Z_)().required(),displayName:(0,x.Z_)().max(50,"Settings.locales.modal.locales.displayName.error").required(u.translatedErrors.required)});var J=t(22572);const ge=()=>{const{values:l,setFieldValue:n}=(0,M.useFormikContext)(),{formatMessage:o}=(0,v.Z)();return e.createElement(J.X,{hint:o({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>n("isDefault",!l.isDefault),value:l.isDefault},o({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};var K=t(23298),D=t(74577),Y=t(12881),fe=t(8295),ve=t(61121),Ee=t(51926),ye=t(40464);const k=()=>{const{formatMessage:l}=(0,v.Z)(),{notifyStatus:n}=(0,Ee.G)(),o=(0,u.useNotification)(),{get:a}=(0,u.useFetchClient)(),{isLoading:i,data:d}=(0,ye.useQuery)(["plugin-i18n","locales"],async()=>{try{const{data:r}=await a("/i18n/iso-locales");return n(l({id:(0,s.O)("Settings.locales.modal.locales.loaded"),defaultMessage:"The locales have been successfully loaded."})),r}catch{return o({type:"warning",message:{id:"notification.error"}}),[]}});return{defaultLocales:d,isLoading:i}},Z=e.memo(({value:l,onClear:n,onLocaleChange:o,error:a})=>{const{formatMessage:i}=(0,v.Z)(),{defaultLocales:d,isLoading:r}=k(),{locales:m}=(0,z.Z)(),g=(d||[]).map(f=>({label:f.name,value:f.code})).filter(({value:f})=>{const h=m.find(({code:O})=>O===f);return!h||h.code===l}),p=l||"";return e.createElement(fe.hQ,{"aria-busy":r,error:a,label:i({id:(0,s.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:p,onClear:l?n:void 0,onChange:f=>{const h=g.find(O=>O.value===f);h&&o({code:h.value,displayName:h.label})},placeholder:i({id:"components.placeholder.select",defaultMessage:"Select"})},g.map(f=>e.createElement(ve.O,{value:f.value,key:f.value},f.label)))});Z.defaultProps={error:void 0,value:void 0,onClear(){},onLocaleChange:()=>{}},Z.propTypes={error:c().string,onClear:c().func,onLocaleChange:c().func,value:c().string};const he=Z,pe=()=>{const{formatMessage:l}=(0,v.Z)(),{values:n,handleChange:o,setFieldValue:a,errors:i}=(0,M.useFormikContext)(),d=(0,e.useCallback)(m=>{a("displayName",m.displayName),a("code",m.code)},[a]),r=(0,e.useCallback)(()=>{a("displayName",""),a("code","")},[a]);return e.createElement(K.r,{gap:4},e.createElement(D.P,{col:6},e.createElement(he,{error:i.code,value:n.code,onLocaleChange:d,onClear:r})),e.createElement(D.P,{col:6},e.createElement(Y.o,{name:"displayName",label:l({id:(0,s.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:l({id:(0,s.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?l({id:(0,s.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:n.displayName,onChange:o})))},Le={code:"",displayName:"",isDefault:!1},w=({onClose:l})=>{const{isAdding:n,addLocale:o}=ue(),{formatMessage:a}=(0,v.Z)(),{refetchPermissions:i}=(0,u.useRBACProvider)(),d=async r=>{await o({code:r.code,name:r.displayName,isDefault:r.isDefault}),await i()};return e.createElement(V.P,{onClose:l,labelledBy:"add-locale-title"},e.createElement(M.Formik,{initialValues:Le,onSubmit:d,validationSchema:$,validateOnChange:!1},e.createElement(u.Form,null,e.createElement(G.x,null,e.createElement(E.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"add-locale-title"},a({id:(0,s.O)("Settings.list.actions.add"),defaultMessage:"Add new locale"}))),e.createElement(H.f,null,e.createElement(U.v,{label:a({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(T.k,{justifyContent:"space-between"},e.createElement(E.Z,{as:"h2",variant:"beta"},a({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(C.m,null,e.createElement(C.O,null,a({id:(0,s.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(C.O,null,a({id:(0,s.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement(W.i,null),e.createElement(j.x,{paddingTop:7,paddingBottom:7},e.createElement(S.n,null,e.createElement(S.x,null,e.createElement(pe,null)),e.createElement(S.x,null,e.createElement(ge,null)))))),e.createElement(Q.m,{startActions:e.createElement(L.z,{variant:"tertiary",onClick:l},a({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(L.z,{type:"submit",startIcon:e.createElement(X.Z,null),disabled:n},a({id:"global.save",defaultMessage:"Save"}))}))))};w.propTypes={onClose:c().func.isRequired};const Ce=w,Se=()=>{const[l,n]=(0,e.useState)(!1),o=(0,F.I0)(),a=(0,u.useNotification)(),{del:i}=(0,u.useFetchClient)();return{isDeleting:l,deleteLocale:async r=>{try{n(!0),await i(`/i18n/locales/${r}`),a({type:"success",message:{id:(0,s.O)("Settings.locales.modal.delete.success")}}),o({type:N.HC,id:r})}catch{a({type:"warning",message:{id:"notification.error"}})}finally{n(!1)}}}},A=({localeToDelete:l,onClose:n})=>{const{isDeleting:o,deleteLocale:a}=Se(),i=Boolean(l),d=()=>a(l.id).then(n);return e.createElement(u.ConfirmDialog,{isConfirmButtonLoading:o,onConfirm:d,onToggleDialog:n,isOpen:i})};A.defaultProps={localeToDelete:void 0},A.propTypes={localeToDelete:c().shape({id:c().number.isRequired}),onClose:c().func.isRequired};const Me=A,Oe=()=>{const[l,n]=(0,e.useState)(!1),o=(0,F.I0)(),a=(0,u.useNotification)(),{put:i}=(0,u.useFetchClient)();return{isEditing:l,editLocale:async(r,m)=>{try{n(!0);const{data:g}=await i(`/i18n/locales/${r}`,m);a({type:"success",message:{id:(0,s.O)("Settings.locales.modal.edit.success")}}),o({type:N.OT,editedLocale:g})}catch{a({type:"warning",message:{id:"notification.error"}})}finally{n(!1)}}}},q=({isDefaultLocale:l})=>{const{values:n,setFieldValue:o}=(0,M.useFormikContext)(),{formatMessage:a}=(0,v.Z)();return e.createElement(J.X,{name:"isDefault",hint:a({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>o("isDefault",!n.isDefault),value:n.isDefault,disabled:l},a({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};q.propTypes={isDefaultLocale:c().bool.isRequired};const De=q;var Te=t(5627),Fe=t(78955);const _=({locale:l})=>{const{formatMessage:n}=(0,v.Z)(),{values:o,handleChange:a,errors:i}=(0,M.useFormikContext)(),{defaultLocales:d,isLoading:r}=k(),m=!r&&d.find(g=>g.code===l.code);return e.createElement(K.r,{gap:4},e.createElement(D.P,{col:6},e.createElement(Te.P,{label:n({id:(0,s.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:m?.code||l.code,disabled:!0},e.createElement(Fe.W,{value:m?.code||l.code},m?.name||l.code))),e.createElement(D.P,{col:6},e.createElement(Y.o,{name:"displayName",label:n({id:(0,s.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:n({id:(0,s.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?n({id:(0,s.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:o.displayName,onChange:a})))},Ne=_;_.propTypes={locale:c().shape({id:c().number.isRequired,name:c().string.isRequired,code:c().string.isRequired,isDefault:c().bool.isRequired}).isRequired};const R=({locale:l,onClose:n})=>{const{refetchPermissions:o}=(0,u.useRBACProvider)(),{isEditing:a,editLocale:i}=Oe(),{formatMessage:d}=(0,v.Z)(),r=async({displayName:m,isDefault:g})=>{await i(l.id,{name:m,isDefault:g}),await o()};return e.createElement(V.P,{onClose:n,labelledBy:"edit-locale-title"},e.createElement(M.Formik,{initialValues:{code:l?.code,displayName:l?.name||"",isDefault:Boolean(l?.isDefault)},onSubmit:r,validationSchema:$},e.createElement(u.Form,null,e.createElement(G.x,null,e.createElement(E.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"edit-locale-title"},d({id:(0,s.O)("Settings.list.actions.edit"),defaultMessage:"Edit a locale"}))),e.createElement(H.f,null,e.createElement(U.v,{label:d({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(T.k,{justifyContent:"space-between"},e.createElement(E.Z,{as:"h2"},d({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(C.m,null,e.createElement(C.O,null,d({id:(0,s.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(C.O,null,d({id:(0,s.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement(W.i,null),e.createElement(j.x,{paddingTop:7,paddingBottom:7},e.createElement(S.n,null,e.createElement(S.x,null,e.createElement(Ne,{locale:l})),e.createElement(S.x,null,e.createElement(De,{isDefaultLocale:Boolean(l&&l.isDefault)})))))),e.createElement(Q.m,{startActions:e.createElement(L.z,{variant:"tertiary",onClick:n},d({id:"app.components.Button.cancel"})),endActions:e.createElement(L.z,{type:"submit",startIcon:e.createElement(X.Z,null),disabled:a},d({id:"global.save"}))}))))};R.defaultProps={locale:void 0},R.propTypes={locale:c().shape({id:c().number.isRequired,name:c().string.isRequired,code:c().string.isRequired,isDefault:c().bool.isRequired}),onClose:c().func.isRequired};const xe=R;var Ze=t(70774),Ae=t(38101),ee=t(93153),y=t(50086),Re=t(10989),Pe=t(86967),te=t(4987),Be=t(26784),be=t(78665);const P=({locales:l,onDeleteLocale:n,onEditLocale:o})=>{const{formatMessage:a}=(0,v.Z)();return e.createElement(Ze.i,{colCount:4,rowCount:l.length+1},e.createElement(Ae.h,null,e.createElement(ee.Tr,null,e.createElement(y.Th,null,e.createElement(E.Z,{variant:"sigma",textColor:"neutral600"},a({id:(0,s.O)("Settings.locales.row.id")}))),e.createElement(y.Th,null,e.createElement(E.Z,{variant:"sigma",textColor:"neutral600"},a({id:(0,s.O)("Settings.locales.row.displayName")}))),e.createElement(y.Th,null,e.createElement(E.Z,{variant:"sigma",textColor:"neutral600"},a({id:(0,s.O)("Settings.locales.row.default-locale")}))),e.createElement(y.Th,null,e.createElement(Re.T,null,"Actions")))),e.createElement(Pe.p,null,l.map(i=>e.createElement(ee.Tr,{key:i.id,...(0,u.onRowClick)({fn:()=>o(i),condition:o})},e.createElement(y.Td,null,e.createElement(E.Z,{textColor:"neutral800"},i.id)),e.createElement(y.Td,null,e.createElement(E.Z,{textColor:"neutral800"},i.name)),e.createElement(y.Td,null,e.createElement(E.Z,{textColor:"neutral800"},i.isDefault?a({id:(0,s.O)("Settings.locales.default")}):null)),e.createElement(y.Td,null,e.createElement(T.k,{gap:1,justifyContent:"flex-end",...u.stopPropagation},o&&e.createElement(te.h,{onClick:()=>o(i),label:a({id:(0,s.O)("Settings.list.actions.edit")}),icon:e.createElement(Be.Z,null),noBorder:!0}),n&&!i.isDefault&&e.createElement(te.h,{onClick:()=>n(i),label:a({id:(0,s.O)("Settings.list.actions.delete")}),icon:e.createElement(be.Z,null),noBorder:!0})))))))};P.defaultProps={locales:[],onDeleteLocale:void 0,onEditLocale:void 0},P.propTypes={locales:c().array,onDeleteLocale:c().func,onEditLocale:c().func};const Ie=P,B=({canUpdateLocale:l,canDeleteLocale:n,onToggleCreateModal:o,isCreating:a})=>{const[i,d]=(0,e.useState)(),[r,m]=(0,e.useState)(),{locales:g}=(0,z.Z)(),{formatMessage:p}=(0,v.Z)();(0,u.useFocusWhenNavigate)();const f=()=>d(void 0),h=n?d:void 0,O=()=>m(void 0),He=l?m:void 0;return e.createElement(se.o,{tabIndex:-1},e.createElement(oe.T,{primaryAction:e.createElement(L.z,{startIcon:e.createElement(I.Z,null),onClick:o,size:"S"},p({id:(0,s.O)("Settings.list.actions.add")})),title:p({id:(0,s.O)("plugin.name")}),subtitle:p({id:(0,s.O)("Settings.list.description")})}),e.createElement(ie.D,null,g?.length>0?e.createElement(Ie,{locales:g,onDeleteLocale:h,onEditLocale:He}):e.createElement(ce.x,{icon:e.createElement(de.Z,{width:void 0,height:void 0}),content:p({id:(0,s.O)("Settings.list.empty.title")}),action:o?e.createElement(L.z,{variant:"secondary",startIcon:e.createElement(I.Z,null),onClick:o},p({id:(0,s.O)("Settings.list.actions.add")})):null})),a&&e.createElement(Ce,{onClose:o}),r&&e.createElement(xe,{onClose:O,locale:r}),e.createElement(Me,{localeToDelete:i,onClose:f}))};B.defaultProps={onToggleCreateModal:void 0},B.propTypes={canUpdateLocale:c().bool.isRequired,canDeleteLocale:c().bool.isRequired,onToggleCreateModal:c().func,isCreating:c().bool.isRequired};const ze=B,ae=({canReadLocale:l,canCreateLocale:n,canDeleteLocale:o,canUpdateLocale:a})=>{const[i,d]=(0,e.useState)(!1),r=n?()=>d(m=>!m):void 0;return l?e.createElement(ze,{canUpdateLocale:a,canDeleteLocale:o,onToggleCreateModal:r,isCreating:i}):null};ae.propTypes={canReadLocale:c().bool.isRequired,canCreateLocale:c().bool.isRequired,canUpdateLocale:c().bool.isRequired,canDeleteLocale:c().bool.isRequired};const Ve=ae,Ge=()=>{const{isLoading:l,allowedActions:{canRead:n,canUpdate:o,canCreate:a,canDelete:i}}=(0,u.useRBAC)(le._);return l?null:e.createElement(Ve,{canReadLocale:n,canCreateLocale:a,canUpdateLocale:o,canDeleteLocale:i})}}}]);
