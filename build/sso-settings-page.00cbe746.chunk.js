"use strict";(self.webpackChunkcmssample=self.webpackChunkcmssample||[]).push([[302],{51754:(U,u,e)=>{e.d(u,{F:()=>p});var t=e(27279),m=e(57537),L=e(61020),M=e(40464);const p=(y={},C={})=>{const{id:i="",...f}=y,{get:g}=(0,m.useFetchClient)(),{locale:O}=(0,L.Z)(),h=(0,m.useCollator)(O,{sensitivity:"base"}),{data:n,error:v,isError:o,isLoading:P,refetch:A}=(0,M.useQuery)(["roles",i,f],async()=>{const{data:r}=await g(`/admin/roles/${i??""}`,{params:f});return r},C);return{roles:t.useMemo(()=>{let r=[];return i&&n?r=[n.data]:Array.isArray(n?.data)&&(r=n.data),[...r].sort((E,I)=>h.compare(E.name,I.name))},[n,i,h]),error:v,isError:o,isLoading:P,refetch:A}}},29388:(U,u,e)=>{e.r(u),e.d(u,{SingleSignOn:()=>F,default:()=>Z});var t=e(27279),m=e(27997),L=e(9941),M=e(27875),p=e(48102),y=e(74758),C=e(10701),i=e(21395),f=e(23298),g=e(74577),O=e(2548),h=e(5627),n=e(78955),v=e(97232),o=e(57537),P=e(59082),A=e(6078),B=e.n(A),r=e(61020),E=e(49402),I=e(92807),W=e(51754),b=e(36364),c=e(47853);const x=c.Ry().shape({autoRegister:c.Xg().required(o.translatedErrors.required),defaultRole:c.nK().when("autoRegister",(a,l)=>a?l.required(o.translatedErrors.required):l.nullable()),ssoLockedRoles:c.IX().nullable().of(c.nK().when("ssoLockedRoles",(a,l)=>a?l.required(o.translatedErrors.required):l.nullable()))}),F=()=>{(0,o.useFocusWhenNavigate)();const{formatMessage:a}=(0,r.Z)(),l=(0,E.v9)(b._),{isLoading:G,allowedActions:{canUpdate:D,canReadRoles:z}}=(0,o.useRBAC)({...l.settings.sso,readRoles:l.settings.roles.read}),[{formErrors:d,initialData:H,isLoading:N,modifiedData:R,showHeaderButtonLoader:X},,{handleChange:S,handleSubmit:Q}]=(0,I.G4)("/admin/providers/options",x,()=>{},["autoRegister","defaultRole","ssoLockedRoles"]),{roles:K,isLoading:$}=(0,W.F)(void 0,{enabled:z}),j=G||$||N;return t.createElement(m.A,null,t.createElement(o.SettingsPageTitle,{name:"SSO"}),t.createElement(L.o,{tabIndex:-1},t.createElement("form",{onSubmit:Q},t.createElement(M.T,{primaryAction:t.createElement(p.z,{"data-testid":"save-button",disabled:B()(H,R),loading:X,startIcon:t.createElement(P.Z,null),type:"submit",size:"L"},a({id:"global.save",defaultMessage:"Save"})),title:a({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:a({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),t.createElement(y.D,null,j?t.createElement(o.LoadingIndicatorPage,null):t.createElement(C.k,{direction:"column",alignItems:"stretch",gap:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},t.createElement(i.Z,{variant:"delta",as:"h2"},a({id:"global.settings",defaultMessage:"Settings"})),t.createElement(f.r,{gap:4},t.createElement(g.P,{col:6,m:6,s:12},t.createElement(O.s,{"aria-label":"autoRegister","data-testid":"autoRegister",disabled:!D,checked:R.autoRegister,hint:a({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:a({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:a({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:a({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:s=>{S({target:{name:"autoRegister",value:s.target.checked}})}})),t.createElement(g.P,{col:6,m:6,s:12},t.createElement(h.P,{disabled:!D,hint:a({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:d.defaultRole?a({id:d.defaultRole.id,defaultMessage:d.defaultRole.id}):"",label:a({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:s=>{S({target:{name:"defaultRole",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:R.defaultRole},K.map(({id:s,name:T})=>t.createElement(n.W,{key:s,value:s.toString()},T)))),t.createElement(g.P,{col:6,m:6,s:12},t.createElement(v.NU,{disabled:!D,hint:a({id:"Settings.sso.form.localAuthenticationLock.description",defaultMessage:"Select the roles for which you want to disable the local authentication"}),error:d.ssoLockedRoles?a({id:d.ssoLockedRoles.id,defaultMessage:d.ssoLockedRoles.id}):"",label:a({id:"Settings.sso.form.localAuthenticationLock.label",defaultMessage:"Local authentication lock-out"}),name:"ssoLockedRoles",onChange:s=>{S({target:{name:"ssoLockedRoles",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),onClear:()=>{S({target:{name:"ssoLockedRoles",emptyArray:[]}})},value:R.ssoLockedRoles||[],withTags:!0},K.map(({id:s,name:T})=>t.createElement(v.ML,{key:s,value:s.toString()},T))))))))))},Z=()=>{const a=(0,E.v9)(b._);return t.createElement(o.CheckPagePermissions,{permissions:a.settings.sso.main},t.createElement(F,null))}}}]);
