"use strict";(self.webpackChunkcmssample=self.webpackChunkcmssample||[]).push([[349],{52713:(I,v,t)=>{t.d(v,{r:()=>i});var e=t(27279),n=t(93415),c=t(70627),T=t.n(c),w=t(67621);function m(d,E,a){if(!d||!E)return{display:"none"};const{x:s,y:o}=a;return{transform:`translate(${s}px, ${o}px)`}}function i({renderItem:d}){const{itemType:E,isDragging:a,item:s,initialOffset:o,currentOffset:p,mouseOffset:y}=(0,w.useDragLayer)(f=>({item:f.getItem(),itemType:f.getItemType(),initialOffset:f.getInitialSourceClientOffset(),currentOffset:f.getSourceClientOffset(),isDragging:f.isDragging(),mouseOffset:f.getClientOffset()}));return a?e.createElement(n.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},e.createElement(n.x,{style:m(o,p,y)},d({type:E,item:s}))):null}i.propTypes={renderItem:T().func.isRequired}},75021:(I,v,t)=>{t.d(v,{q:()=>T});var e=t(27279),n=t(57537),c=t(40464);function T({enabled:w}={enabled:!0}){const{get:m}=(0,n.useFetchClient)(),{data:i,isError:d,isLoading:E}=(0,c.useQuery)(["ee","license-limit-info"],async()=>{const{data:{data:o}}=await m("/admin/license-limit-information");return o},{enabled:w}),a=e.useMemo(()=>i??{},[i]),s=e.useCallback(o=>(a?.features??[]).find(y=>y.name===o)?.options??{},[a?.features]);return{license:a,getFeature:s,isError:d,isLoading:E}}},43390:(I,v,t)=>{t.d(v,{eJ:()=>W,lx:()=>R,h4:()=>u,fC:()=>P});var e=t(27279),n=t(27997),c=t(9941),T=t(74758),w=t(27875),m=t(57537),i=t(76827),d=t(61020),E=t(52713),a=t(86978),s=t(10701),o=t(21395),p=t(10411),y=t(70627),f=t.n(y),C=t(72450);const A=(0,C.default)(s.k)`
  svg path {
    fill: ${({theme:g})=>g.colors.neutral600};
  }
`;function S({name:g}){return e.createElement(s.k,{background:"primary100",borderStyle:"dashed",borderColor:"primary600",borderWidth:"1px",gap:3,hasRadius:!0,padding:3,shadow:"tableShadow",width:(0,m.pxToRem)(300)},e.createElement(A,{alignItems:"center",background:"neutral200",borderRadius:"50%",height:6,justifyContent:"center",width:6},e.createElement(p.Z,{width:`${8/16}rem`})),e.createElement(o.Z,{fontWeight:"bold"},g))}S.propTypes={name:f().string.isRequired};function h({type:g,item:O}){switch(g){case a.uL.STAGE:return e.createElement(S,{...O});default:return null}}function R(){return e.createElement(E.r,{renderItem:h})}function P({children:g}){return e.createElement(n.A,null,e.createElement(c.o,{tabIndex:-1},e.createElement(T.D,null,g)))}function W({href:g}){const{formatMessage:O}=(0,d.Z)();return e.createElement(m.Link,{startIcon:e.createElement(i.Z,null),to:g},O({id:"global.back",defaultMessage:"Back"}))}function u({title:g,subtitle:O,navigationAction:D,primaryAction:L}){return e.createElement(e.Fragment,null,e.createElement(m.SettingsPageTitle,{name:g}),e.createElement(w.T,{navigationAction:D,primaryAction:L,title:g,subtitle:O}))}},38705:(I,v,t)=>{t.d(v,{uT:()=>h,fC:()=>W,Dx:()=>S});var e=t(27279),n=t(21395),c=t(10701),T=t(5938),w=t(15244),m=t(93415),i=t(4987),d=t(37370),E=t(95066),a=t(70627),s=t.n(a),o=t(61020),p=t(72450);const y=t.p+"0cd5f8915b265d5b1856.png",f="limits-title",C="https://strapi.io/pricing-cloud",A="https://strapi.io/contact-sales";function S({children:u}){return e.createElement(n.Z,{variant:"alpha",id:f},u)}S.propTypes={children:s().node.isRequired};function h({children:u}){return e.createElement(n.Z,{variant:"omega"},u)}h.propTypes={children:s().node.isRequired};function R(){const{formatMessage:u}=(0,o.Z)();return e.createElement(c.k,{gap:2,paddingTop:4},e.createElement(d.Q,{variant:"default",isExternal:!0,href:C},u({id:"Settings.review-workflows.limit.cta.learn",defaultMessage:"Learn more"})),e.createElement(d.Q,{variant:"tertiary",isExternal:!0,href:A},u({id:"Settings.review-workflows.limit.cta.sales",defaultMessage:"Contact Sales"})))}const P=p.default.img`
  // Margin top|right reverse the padding of ModalBody
  margin-right: ${({theme:u})=>`-${u.spaces[7]}`};
  margin-top: ${({theme:u})=>`-${u.spaces[7]}`};
  width: 360px;
`;function W({children:u,isOpen:g,onClose:O}){const{formatMessage:D}=(0,o.Z)();return g?e.createElement(T.P,{labelledBy:f},e.createElement(w.f,null,e.createElement(c.k,{gap:2,paddingLeft:7,position:"relative"},e.createElement(c.k,{alignItems:"start",direction:"column",gap:2,width:"60%"},u,e.createElement(R,null)),e.createElement(c.k,{justifyContent:"end",height:"100%",width:"40%"},e.createElement(P,{src:y,"aria-hidden":!0,alt:"",loading:"lazy"}),e.createElement(m.x,{display:"flex",position:"absolute",right:0,top:0},e.createElement(i.h,{icon:e.createElement(E.Z,null),"aria-label":D({id:"global.close",defaultMessage:"Close"}),onClick:O})))))):null}W.defaultProps={isOpen:!1},W.propTypes={children:s().node.isRequired,isOpen:s().bool,onClose:s().func.isRequired}},86978:(I,v,t)=>{t.d(v,{$k:()=>y,Ef:()=>h,FT:()=>A,Nj:()=>o,Ot:()=>a,QM:()=>d,VS:()=>f,_X:()=>R,bc:()=>s,gu:()=>c,k_:()=>p,lv:()=>C,qZ:()=>i,rg:()=>w,sN:()=>n,uL:()=>S,x4:()=>E,yq:()=>T,zn:()=>m});var e=t(97003);const n="settings_review-workflows",c="Settings/Review_Workflows/RESET_WORKFLOW",T="Settings/Review_Workflows/SET_CONTENT_TYPES",w="Settings/Review_Workflows/SET_IS_LOADING",m="Settings/Review_Workflows/SET_ROLES",i="Settings/Review_Workflows/SET_WORKFLOW",d="Settings/Review_Workflows/SET_WORKFLOWS",E="Settings/Review_Workflows/WORKFLOW_DELETE_STAGE",a="Settings/Review_Workflows/WORKFLOW_ADD_STAGE",s="Settings/Review_Workflows/WORKFLOW_CLONE_STAGE",o="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGE",p="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGES",y="Settings/Review_Workflows/WORKFLOW_UPDATE_STAGE_POSITION",f="Settings/Review_Workflows/WORKFLOW_UPDATE",C={primary600:"Blue",primary200:"Lilac",alternative600:"Violet",alternative200:"Lavender",success600:"Green",success200:"Pale Green",danger500:"Cherry",danger200:"Pink",warning600:"Orange",warning200:"Yellow",secondary600:"Teal",secondary200:"Baby Blue",neutral400:"Gray",neutral0:"White"},A=e.W.colors.primary600,S={STAGE:"stage"},h="numberOfWorkflows",R="stagesPerWorkflow"},52258:(I,v,t)=>{t.d(v,{n:()=>T});var e=t(27279),n=t(57537),c=t(40464);function T(w={}){const{get:m}=(0,n.useFetchClient)(),{id:i="",...d}=w,E={populate:"stages"},{data:a,isLoading:s,status:o,refetch:p}=(0,c.useQuery)(["review-workflows","workflows",i],async()=>(await m(`/admin/review-workflows/workflows/${i}`,{params:{...E,...d}})).data),y=e.useMemo(()=>i&&a?.data?[a.data]:Array.isArray(a?.data)?a.data:[],[a?.data,i]);return{meta:e.useMemo(()=>a?.meta??{},[a?.meta]),workflows:y,isLoading:s,status:o,refetch:p}}},26259:(I,v,t)=>{t.r(v),t.d(v,{default:()=>X});var e=t(27279),n=t(57537),c=t(49402),T=t(36364),w=t(10701),m=t(77970),i=t(70774),d=t(38566),E=t(38101),a=t(93153),s=t(50086),o=t(21395),p=t(10989),y=t(86967),f=t(4987),C=t(36938),A=t(26784),S=t(78665),h=t(61020),R=t(40464),P=t(51447),W=t(72450),u=t(92686),g=t(75021),O=t(43390),D=t(38705),L=t(86978),V=t(52258);const Y=(0,W.default)(n.Link)`
  align-items: center;
  height: ${(0,n.pxToRem)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:l})=>`${l.spaces[2]}}`};
  width: ${(0,n.pxToRem)(32)};

  svg {
    height: ${(0,n.pxToRem)(12)};
    width: ${(0,n.pxToRem)(12)};

    path {
      fill: ${({theme:l})=>l.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:l})=>l.colors.neutral800};
      }
    }
  }
`;function z(){const{formatMessage:l}=(0,h.Z)(),{push:K}=(0,P.k6)(),{collectionTypes:J,singleTypes:b,isLoading:q}=(0,u.G)(),{meta:N,workflows:$,isLoading:F,refetch:_}=(0,V.n)(),[Z,B]=e.useState(null),[ee,k]=e.useState(!1),{del:te}=(0,n.useFetchClient)(),{formatAPIError:ne}=(0,n.useAPIErrorHandler)(),U=(0,n.useNotification)(),{getFeature:se,isLoading:j}=(0,g.q)(),{trackUsage:H}=(0,n.useTracking)(),ae=(0,c.v9)(T._),{allowedActions:{canCreate:Q,canDelete:oe}}=(0,n.useRBAC)(ae.settings["review-workflows"]),M=se("review-workflows"),{mutateAsync:le,isLoading:re}=(0,R.useMutation)(async({workflowId:r,stages:x})=>{const{data:{data:G}}=await te(`/admin/review-workflows/workflows/${r}`,{data:x});return G},{onSuccess(){U({type:"success",message:{id:"notification.success.deleted",defaultMessage:"Deleted"}})}}),ie=r=>[...J,...b].find(G=>G.uid===r).info.displayName,ce=r=>{B(r)},de=()=>{B(null)},fe=async()=>{try{const r=await le({workflowId:Z});return await _(),B(null),r}catch(r){return U({type:"warning",message:ne(r)}),null}};return e.useEffect(()=>{!F&&!j&&M?.[L.Ef]&&N?.workflowCount>parseInt(M[L.Ef],10)&&k(!0)},[j,F,M,N?.workflowCount,N.workflowsTotal]),e.createElement(e.Fragment,null,e.createElement(O.h4,{primaryAction:Q&&e.createElement(n.LinkButton,{startIcon:e.createElement(C.Z,null),size:"S",to:"/settings/review-workflows/create",onClick:r=>{M?.[L.Ef]&&N?.workflowCount>=parseInt(M[L.Ef],10)?(r.preventDefault(),k(!0)):H("willCreateWorkflow")}},l({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})),subtitle:l({id:"Settings.review-workflows.list.page.subtitle",defaultMessage:"Manage your content review process"}),title:l({id:"Settings.review-workflows.list.page.title",defaultMessage:"Review Workflows"})}),e.createElement(O.fC,null,F||q?e.createElement(w.k,{justifyContent:"center"},e.createElement(m.a,null,l({id:"Settings.review-workflows.page.list.isLoading",defaultMessage:"Workflows are loading"}))):e.createElement(i.i,{colCount:3,footer:Q&&e.createElement(d.c,{icon:e.createElement(C.Z,null),onClick:()=>{M?.[L.Ef]&&N?.workflowCount>=parseInt(M[L.Ef],10)?k(!0):(K("/settings/review-workflows/create"),H("willCreateWorkflow"))}},l({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})),rowCount:1},e.createElement(E.h,null,e.createElement(a.Tr,null,e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},l({id:"Settings.review-workflows.list.page.list.column.name.title",defaultMessage:"Name"}))),e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},l({id:"Settings.review-workflows.list.page.list.column.stages.title",defaultMessage:"Stages"}))),e.createElement(s.Th,null,e.createElement(o.Z,{variant:"sigma"},l({id:"Settings.review-workflows.list.page.list.column.contentTypes.title",defaultMessage:"Content Types"}))),e.createElement(s.Th,null,e.createElement(p.T,null,l({id:"Settings.review-workflows.list.page.list.column.actions.title",defaultMessage:"Actions"}))))),e.createElement(y.p,null,$.map(r=>e.createElement(a.Tr,{...(0,n.onRowClick)({fn(x){x.target.nodeName!=="BUTTON"&&K(`/settings/review-workflows/${r.id}`)}}),key:`workflow-${r.id}`},e.createElement(s.Td,{width:(0,n.pxToRem)(250)},e.createElement(o.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0},r.name)),e.createElement(s.Td,null,e.createElement(o.Z,{textColor:"neutral800"},r.stages.length)),e.createElement(s.Td,null,e.createElement(o.Z,{textColor:"neutral800"},(r?.contentTypes??[]).map(ie).join(", "))),e.createElement(s.Td,null,e.createElement(w.k,{alignItems:"center",justifyContent:"end"},e.createElement(Y,{to:`/settings/review-workflows/${r.id}`,"aria-label":l({id:"Settings.review-workflows.list.page.list.column.actions.edit.label",defaultMessage:"Edit {name}"},{name:r.name})},e.createElement(A.Z,null)),$.length>1&&oe&&e.createElement(f.h,{"aria-label":l({id:"Settings.review-workflows.list.page.list.column.actions.delete.label",defaultMessage:"Delete {name}"},{name:"Default workflow"}),icon:e.createElement(S.Z,null),noBorder:!0,onClick:()=>{ce(r.id)}}))))))),e.createElement(n.ConfirmDialog,{bodyText:{id:"Settings.review-workflows.list.page.delete.confirm.body",defaultMessage:"If you remove this worfklow, all stage-related information will be removed for this content-type. Are you sure you want to remove it?"},isConfirmButtonLoading:re,isOpen:!!Z,onToggleDialog:de,onConfirm:fe}),e.createElement(D.fC,{isOpen:ee,onClose:()=>k(!1)},e.createElement(D.Dx,null,l({id:"Settings.review-workflows.list.page.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})),e.createElement(D.uT,null,l({id:"Settings.review-workflows.list.page.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})))))}function X(){const l=(0,c.v9)(T._);return e.createElement(n.CheckPagePermissions,{permissions:l.settings["review-workflows"].main},e.createElement(z,null))}}}]);
